# vim: filetype=gitconfig

[user]
  name  = Simon Coffey
  email = simon@urbanautomaton.com

[alias]
  f     = "!f() { local ref=$1; [[ -n \"$ref\" ]] || ref=HEAD; git commit --fixup=$ref; }; f"
  s     = "!f() { local ref=$1; [[ -n \"$ref\" ]] || ref=HEAD; git commit --squash=$ref; }; f"
  d     = diff
  dw    = diff --word-diff
  st    = status -sb
  l     = log --graph --pretty=format:'%C(yellow)%h%Creset -%C(red)%d%Creset %s %Cgreen(%ar) %C(bold blue)<%an>%Creset' --abbrev-commit --decorate
  sed   = ! git ls-files -z | xargs -0 sed -i -e
  ctags = ! .git/hooks/ctags
  lm    = "!f() { local method=$1; local file=$2; [[ -n \"$method\" && -n \"$file\" ]] || exit 1; git log -L :$method:$file; }; f"
  lmw   = "!f() { local method=$1; local file=$2; [[ -n \"$method\" && -n \"$file\" ]] || exit 1; git log -w -L :$method:$file; }; f"

  unchanged        = update-index --assume-unchanged
  nounchanged      = update-index --no-assume-unchanged
  marked-unchanged = !git ls-files -v | grep "^[[:lower:]]" | cut -f2 -d' '
  reset-unchanged  = !git update-index --no-assume-unchanged $(git marked-unchanged)
  tracking-changes = !git fetch && git diff --stat HEAD...@{u}

  root = rev-parse --show-toplevel

[merge]
  keepBackup = false
  tool       = p4mergetool

[mergetool "p4mergetool"]
  keepBackup = false
  cmd = "/Applications/p4merge.app/Contents/Resources/launchp4merge $PWD/$BASE $PWD/$LOCAL $PWD/$REMOTE $PWD/$MERGED"
  trustExitCode = false

[diff]
  tool = p4mergetool
  algorithm = patience

[difftool "p4mergetool"]
  cmd = "/Applications/p4merge.app/Contents/Resources/launchp4merge $LOCAL $REMOTE"

[status]
  showuntrackedfiles = all

[color]
  diff        = auto
  status      = auto
  branch      = auto
  interactive = auto
  ui          = true
  pager       = true

[color "branch"]
  current = yellow reverse
  local   = yellow
  remote  = green

[color "diff"]
  meta = yellow bold
  frag = magenta bold
  old  = red bold
  new  = green bold

[color "status"]
  added     = yellow
  changed   = green
  untracked = cyan

[format]
  pretty=format:%C(yellow)%h%Creset -%C(red)%d%Creset %s %Cgreen(%ar) %C(bold blue)<%an>%Creset

[core]
  pager          = less -FRSX
  whitespace     = fix,-indent-with-non-tab,trailing-space,cr-at-eol
  excludesfile   = ~/.gitignore_global
  safecrlf       = true
  attributesFile = ~/.gitattributes

[init]
  templatedir = ~/.git_template

[push]
  default = upstream

[branch]
  autosetuprebase = always
[rebase]
  autosquash = true

[include]
  path = ~/.gitconfig_local
